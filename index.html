<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <title>MindsüëÅÔ∏è‚Äç\U0001f5e8Ô∏èEye</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: black;
      font-family: sans-serif;
    }
    #toolbar {
      position: fixed;
      top: 0;
      width: 100%;
      background: #111;
      color: white;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      z-index: 1000;
    }
    #canvas {
      display: block;
    }
    .panel {
      position: fixed;
      top: 80px;
      left: 50%;
      transform: translateX(-50%);
      width: 400px;
      background: rgba(34, 34, 34, 0.92);
      color: white;
      padding: 20px;
      border-radius: 16px;
      z-index: 999;
      display: none;
    }
    .panel input, .panel textarea {
      width: 100%;
      margin: 5px 0;
      background: #333;
      border: none;
      color: white;
      padding: 5px;
    }
    .panel button {
      margin-right: 10px;
      padding: 6px 12px;
      background: #444;
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="toolbar">
    <div><strong>üßøMindsEyeüßø</strong></div>
    <div>
      <button onclick="saveIdeas()">Save Ideas</button>
      <input type="file" id="fileLoader" accept=".json" style="display:none" />
      <button onclick="document.getElementById('fileLoader').click()">Load Ideas</button>
      <label style="margin-left: 10px;">Speed:
        <input type="range" min="0.0" max="3" step="0.1" value="1" onchange="speedMultiplier = parseFloat(this.value)">
      </label>
      <label style="margin-left: 10px;">Image:
        <input type="file" id="bgLoader" accept="image/*" />
      </label>
      <label style="margin-left: 10px;">Video File:
        <input type="file" id="videoLoader" accept="video/*" />
      </label>
      <label style="margin-left: 10px;">YouTube Link:
        <input type="text" id="youtubeLink" placeholder="Paste YouTube URL" style="width:180px;" />
        <button onclick="loadYouTubeVideo()">Load</button>
      </label>
      <button onclick="clearBackground()" style="margin-left:10px;">Clear BG</button>
    </div>
  </div>

  <video id="bgVideo" autoplay muted loop playsinline style="position:fixed; top:0; left:0; width:100%; height:100%; object-fit:cover; z-index:-2; display:none;"></video>
  <iframe id="ytFrame" frameborder="0" allow="autoplay" allowfullscreen style="position:fixed; top:0; left:0; width:100%; height:100%; z-index:-3; display:none;"></iframe>
  <canvas id="canvas"></canvas>

  <div class="panel" id="panel">
    <input id="title" placeholder="Title" />
    <textarea id="description" rows="5" placeholder="Description"></textarea>
    <label>Size:
      <input type="range" id="sizeSlider" min="10" max="100" value="80" oninput="selectedIdea.radius = parseInt(this.value)">
    </label>
    <div style="margin-top: 10px;">
      <button onclick="savePanel()">Save</button>
      <button onclick="changeColor()">üí≠Ô∏èColor</button>
      <button onclick="changeTextColor()">üí¨Color</button>
      <button onclick="cycleFont()">Font</button>
      <button onclick="deleteIdea()">Delete</button>
      <button onclick="closePanel()">Close</button>
    </div>
  </div>

  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const panel = document.getElementById("panel");
    let width, height;
    function resize() {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    const border = 10;
    let speedMultiplier = 1;
    let ideas = [];
    let selectedIdea = null;
    let backgroundImage = null;
    const fonts = ["Tahoma", "Verdana", "Courier New", "Georgia", "Arial"];
    let fontIndex = 0;

    function randomColor() {
      return `hsl(${Math.random() * 360}, 100%, 70%)`;
    }
    function randomTextColor() {
      const colors = ['white', 'black', 'cyan', 'yellow', 'magenta', 'lime', 'red'];
      return colors[Math.floor(Math.random() * colors.length)];
    }
    function addIdea(x, y, title = "New Idea", description = "", color = randomColor(), textColor = "white", radius = 80) {
      const maxSpeed = 3;
      ideas.push({ title, description, x, y, vx: (Math.random() * 2 - 1) * maxSpeed, vy: (Math.random() * 2 - 1) * maxSpeed, color, textColor, radius, font: fonts[0] });
    }

    canvas.addEventListener("click", (e) => {
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      let clicked = false;
      for (let idea of ideas) {
        const dx = x - idea.x;
        const dy = y - idea.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        if (dist < idea.radius) {
          selectedIdea = idea;
          showPanel();
          clicked = true;
          break;
        }
      }
      if (!clicked) addIdea(x, y);
    });

    function showPanel() {
      document.getElementById("title").value = selectedIdea.title;
      document.getElementById("description").value = selectedIdea.description;
      document.getElementById("sizeSlider").value = selectedIdea.radius || 80;
      panel.style.display = "block";
    }
    function savePanel() {
      selectedIdea.title = document.getElementById("title").value;
      selectedIdea.description = document.getElementById("description").value;
      panel.style.display = "none";
    }
    function deleteIdea() {
      if (selectedIdea) {
        ideas = ideas.filter(idea => idea !== selectedIdea);
        selectedIdea = null;
        panel.style.display = "none";
      }
    }
    function closePanel() { panel.style.display = "none"; }
    function changeColor() { selectedIdea.color = randomColor(); }
    function changeTextColor() { selectedIdea.textColor = randomTextColor(); }
    function cycleFont() {
      fontIndex = (fontIndex + 1) % fonts.length;
      selectedIdea.font = fonts[fontIndex];
    }

    function draw() {
      if (backgroundImage) ctx.drawImage(backgroundImage, 0, 0, width, height);
      else ctx.clearRect(0, 0, width, height);

      for (let i = 0; i < ideas.length; i++) {
        let a = ideas[i];
        a.x += a.vx * speedMultiplier;
        a.y += a.vy * speedMultiplier;

        if (a.x - a.radius < border) { a.x = border + a.radius; a.vx *= -1; }
        if (a.x + a.radius > width - border) { a.x = width - border - a.radius; a.vx *= -1; }
        if (a.y - a.radius < border + 50) { a.y = border + 50 + a.radius; a.vy *= -1; }
        if (a.y + a.radius > height - border) { a.y = height - border - a.radius; a.vy *= -1; }

        for (let j = i + 1; j < ideas.length; j++) {
          let b = ideas[j];
          let dx = a.x - b.x;
          let dy = a.y - b.y;
          let dist = Math.sqrt(dx * dx + dy * dy);
          if (dist < a.radius + b.radius) {
            let angle = Math.atan2(dy, dx);
            let tx = a.x - Math.cos(angle) * (a.radius + b.radius);
            let ty = a.y - Math.sin(angle) * (a.radius + b.radius);
            b.x = tx;
            b.y = ty;
            [a.vx, b.vx] = [b.vx, a.vx];
            [a.vy, b.vy] = [b.vy, a.vy];
          }
        }

        const gradient = ctx.createRadialGradient(a.x, a.y, a.radius * 0.6, a.x, a.y, a.radius);
        gradient.addColorStop(0, a.color);
        gradient.addColorStop(1, "black");
        ctx.beginPath();
        ctx.arc(a.x, a.y, a.radius, 0, Math.PI * 2);
        ctx.fillStyle = gradient;
        ctx.shadowBlur = 10;
        ctx.shadowColor = a.color;
        ctx.fill();
        ctx.shadowBlur = 0;
        ctx.fillStyle = a.textColor || "white";
        ctx.font = "bold 14px " + (a.font || "Tahoma");
        ctx.textAlign = "center";
        const words = a.title.split(" ");
        words.forEach((word, idx) => {
          ctx.fillText(word, a.x, a.y + idx * 16 - (words.length - 1) * 8);
        });
      }
      requestAnimationFrame(draw);
    }
    draw();

    function saveIdeas() {
      const dataToSave = ideas.map(idea => ({ ...idea }));
      const blob = new Blob([JSON.stringify(dataToSave, null, 2)], { type: "application/json" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "ideas.json";
      a.click();
    }

    document.getElementById("fileLoader").addEventListener("change", function (e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function (event) {
        try {
          const loaded = JSON.parse(event.target.result);
          ideas = loaded.map(idea => ({ ...idea, font: idea.font || fonts[0], radius: idea.radius || 80 }));
        } catch (err) {
          alert("Invalid JSON file.");
        }
      };
      reader.readAsText(file);
    });

    document.getElementById("bgLoader").addEventListener("change", function (e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function (event) {
        const img = new Image();
        img.onload = function () {
          backgroundImage = img;
        };
        img.src = event.target.result;
      };
      reader.readAsDataURL(file);
    });

   document.getElementById("videoLoader").addEventListener("change", function (e) {
  const file = e.target.files[0];
  if (!file) return;

  const video = document.getElementById("bgVideo");
  const iframe = document.getElementById("ytFrame");

  backgroundImage = null;
  iframe.style.display = "none";
  iframe.src = "";

  const objectURL = URL.createObjectURL(file); // ‚¨ÖÔ∏è Better than FileReader for video
  video.src = objectURL;
  video.style.display = "block";

  // Force video to reload and play after src set
  video.load();
  video.oncanplaythrough = () => {
    video.play().catch(err => {
      console.warn("Video autoplay blocked. User interaction may be needed.");
    });
  };
});
let isDragging = false;
    let dragOffsetX = 0;
    let dragOffsetY = 0;
    let dragIdea = null;
    let mouseMoved = false;

    canvas.addEventListener("mousedown", (e) => {
      if (speedMultiplier !== 0 || panel.style.display === "block") return;
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      for (let idea of ideas) {
        const dx = x - idea.x;
        const dy = y - idea.y;
        const dist = Math.sqrt(dx * dx + dy * dy);
        if (dist < idea.radius) {
          isDragging = true;
          dragIdea = idea;
          dragOffsetX = dx;
          dragOffsetY = dy;
          mouseMoved = false;
          return;
        }
      }
    });

    canvas.addEventListener("mousemove", (e) => {
      if (isDragging && dragIdea && speedMultiplier === 0) {
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        dragIdea.x = x - dragOffsetX;
        dragIdea.y = y - dragOffsetY;
        mouseMoved = true;
      }
    });

    canvas.addEventListener("mouseup", (e) => {
      if (isDragging && dragIdea && !mouseMoved) {
        selectedIdea = dragIdea;
        showPanel();
      }
      isDragging = false;
      dragIdea = null;
    });
    function loadYouTubeVideo() {
      const url = document.getElementById("youtubeLink").value;
      const match = url.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^\s&]+)/);
      const video = document.getElementById("bgVideo");
      const iframe = document.getElementById("ytFrame");
      if (match) {
        const videoId = match[1];
        const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&controls=0&loop=1&playlist=${videoId}`;
        backgroundImage = null;
        video.style.display = "none";
        video.pause();
        iframe.src = embedUrl;
        iframe.style.display = "block";
      } else {
        alert("Invalid YouTube URL.");
      }
    }

    function clearBackground() {
      backgroundImage = null;
      document.getElementById("bgVideo").style.display = "none";
      document.getElementById("bgVideo").pause();
      document.getElementById("ytFrame").style.display = "none";
      document.getElementById("ytFrame").src = "";
    }

    // Initial Ideas
    addIdea(200, 200, "TV Nasty", "The most ambitious concept");
    addIdea(500, 300, "Lucky Days", "Avatar morning show");
    addIdea(300, 500, "Break Point", "Extreme transitional tale");
    addIdea(600, 250, "Pierette Les Furis", "Stylised femme thriller");
    addIdea(800, 400, "Sound Meadre", "Sound Meadre");
    addIdea(700, 600, "How Not 2 Have an XChange", "Darkly comic documentary");
    addIdea(400, 700, "Stationary", "A Tokyo Love Story");
    addIdea(350, 800, "Free Radicals", "A Real Mocumentary");
    addIdea(750, 750, "To DO", "Other Stuff");
  </script>
</body>
</html>